## Описание

Данная лабораторная работа состоит из нескольких заданий, связанных с анализом данных сотрудников и животных в базе данных. Задания охватывают различные аспекты работы с SQL, включая поиск дублей, расчёт сроков вакцинации, определение штрафов и создание триггеров для мониторинга и контроля данных.

## Задания

### Задание 1: Анализ дублей сотрудников

**Описание задачи**:  
В базе данных содержатся сведения о сотрудниках компании, включая их даты рождения и номера телефонов. Некоторые сотрудники оформлялись и увольнялись несколько раз. Нужно найти сотрудников, которые оформлялись более одного раза, и предоставить информацию о количестве таких дублей, а также последовательную историю их оформления.

**Условия**:  
- Задание основано на данных из файла `employee.csv`.
- Для поиска дублей следует учитывать совпадение по дате рождения и номеру телефона.
- Важно обработать поле `PHONE_EMAIL`, которое содержит номера телефонов в разных форматах и другие данные.

**Задачи**:
1. Загрузить данные о сотрудниках в базу данных.
2. Написать SQL-запрос, который выявит сотрудников, оформлявшихся несколько раз.
3. Подсчитать количество дублей и представить информацию о последовательной истории каждого сотрудника.

### Задание 2: Определение срока вакцинации от бешенства

**Описание задачи**:  
В базе данных животных необходимо рассчитать, сколько дней осталось до окончания срока вакцинации от бешенства для животного, найденного 2020-08-09. Код вакцинации от бешенства — "R".

**Условия**:  
- Используется база данных `PET`.
- Чип животного — 643099183183126.
- Найдено животное 2020-08-09.

**Задачи**:
1. Написать SQL-запрос, который определяет срок до окончания вакцинации от бешенства для указанного животного.

### Задание 3: Расчет штрафов за несвоевременную прививку от бешенства

**Описание задачи**:  
Необходимо рассчитать штрафы для владельцев животных, если они не сделали вовремя прививку от бешенства. Штрафы начисляются за пропущенные дни между вакцинациями и за дни после окончания последней прививки.

**Условия**:  
- В базе данных содержится информация о прививках животных.
- Штраф за пропущенный день составляет 1 рубль.

**Задачи**:
1. Написать SQL-запрос, который выведет чипы животных и сумму штрафа за пропущенные дни.
2. Штрафы должны быть рассчитаны:
   - За дни между окончанием предыдущей прививки и новой.
   - За дни после окончания последней прививки и текущей датой.

### Задание 4: Создание триггеров

**Описание задачи**:  
Необходимо добавить несколько триггеров в базу данных для логирования действий пользователя, проверки диапазона зарплаты сотрудников и отказа от подозрительных операций, проводимых внеурочное время.

**Условия**:  
- Триггеры должны быть направлены на выполнение логирования изменений в базе данных, защиту от некорректных операций и контроль за диапазоном зарплат сотрудников.

**Задачи**:
1. Создать триггер для логирования действий пользователей в системе.
2. Создать триггер для проверки корректности диапазона зарплат сотрудников.
3. Создать триггер для отказа от операций, проводимых внеурочное время.
4. Демонстрировать работу триггеров через таблицы с логами.
